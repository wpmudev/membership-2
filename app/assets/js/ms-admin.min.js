/*! Membership 2 Pro - v1.0.4
 * https://premium.wpmudev.org/project/membership/
 * Copyright (c) 2017; * Licensed GPLv2+ */

window.ms_init=window.ms_init||{},jQuery(function(){function a(a){if(void 0!==a&&void 0!==window.ms_init[a]){if(!0===window.ms_init._done[a])return!1;window.ms_init._done[a]=!0,window.ms_init[a]()}}var b;if(window.ms_init._done=window.ms_init._done||{},void 0!==window.ms_data&&void 0!==ms_data.ms_init){if(ms_data.ms_init instanceof Array)for(b=0;b<ms_data.ms_init.length;b+=1)a(ms_data.ms_init[b]);else a(ms_data.ms_init);ms_data.ms_init=[]}}),window.ms_functions={dp_config:{dateFormat:"yy-mm-dd",dayNamesMin:["Sun","Mon","Tue","Wed","Thy","Fri","Sat"],custom_class:"wpmui-datepicker"},chosen_options:{minimumResultsForSearch:6,width:"auto"},init:function(a){var b=window.ms_functions;jQuery(".ms-wrap select, .ms-select",a).each(function(){var a=jQuery(this);a.closest(".no-auto-init").length||a.closest(".manual-init").length||a.wpmuiSelect(b.chosen_options)}),jQuery(".wpmui-datepicker",a).each(function(){var a=jQuery(this);a.closest(".no-auto-init").length||a.ms_datepicker()}),window.setTimeout(function(){jQuery("body").trigger("resize")},50)},ajax_update:function(a){var b,c,d,e=jQuery(a),f=window.ms_functions,g=e;e.hasClass("ms-processing")||(g.parents(".wpmui-radio-wrapper").length?g=g.parents(".wpmui-radio-wrapper").first():g.parents(".wpmui-radio-slider-wrapper").length?g=g.parents(".wpmui-radio-slider-wrapper").first():g.parents(".wpmui-input-wrapper").length?g=g.parents(".wpmui-input-wrapper").first():g.parents(".wpmui-select-wrapper").length?g=g.parents(".wpmui-select-wrapper").first():g.parents("label").length&&(g=g.parents("label").first()),g.addClass("wpmui-loading"),d=f.ajax_show_indicator(e),b=e.data("wpmui-ajax"),e.is(":checkbox")?b.value=e.prop("checked"):(c=e.val(),c instanceof Array||c instanceof Object||null===c?b.values=c:b.value=c),void 0===b.field&&(b.field=e.attr("name")),"function"==typeof e.data("before_ajax")&&(b=e.data("before_ajax")(b,e)),e.trigger("ms-ajax-start",[b,d,g]),jQuery.post(window.ajaxurl,b,function(a){var c=f.ajax_error(a,d);g.removeClass("wpmui-loading"),d.removeClass("ms-processing"),e.trigger("ms-ajax-updated",[b,a,c])}).always(function(){e.trigger("ms-ajax-done",[b,d,g])}))},radio_slider_ajax_update:function(a){var b,c,d,e,f,g=jQuery(a),h=window.ms_functions;g.hasClass("ms-processing")||g.attr("readonly")||(g.toggleClass("on"),g.toggleClass("off"),g.parent().toggleClass("on"),g.parent().toggleClass("off"),g.trigger("change"),d=g.children(".wpmui-toggle"),b=d.data("wpmui-ajax"),e=d.data("states"),null!==b&&void 0!==b?(c=h.ajax_show_indicator(g),g.addClass("ms-processing wpmui-loading"),f=g.hasClass("on"),void 0!==e.active&&f?b.value=e.active:void 0===e.inactive||f?b.value=f:b.value=e.inactive,"function"==typeof g.data("before_ajax")&&(b=g.data("before_ajax")(b,g)),g.trigger("ms-ajax-start",[b,c,g]),jQuery.post(window.ajaxurl,b,function(a){var d=h.ajax_error(a,c);d&&(g.toggleClass("on"),g.toggleClass("off")),c.removeClass("ms-processing"),g.removeClass("ms-processing wpmui-loading"),g.children("input").val(g.hasClass("on")),b.response=a,g.trigger("ms-ajax-updated",[b,a,d]),g.trigger("ms-radio-slider-updated",[b,d]),g.trigger("wpmui-radio-slider-updated",[b,d])}).always(function(){g.trigger("ms-ajax-done",[b,c,g])})):g.children("input").val(g.hasClass("on")))},dynamic_form_submit:function(a,b){var c,d,e,f,g,h,i=window.ms_functions,j=jQuery(b),k=j.serializeArray(),l={};for(a.preventDefault(),c=0;c<k.length;c+=1)e=k[c].name,d=k[c].value,void 0===l[e]?l[e]=d:(l[e]instanceof Array||(l[e]=[l[e]]),l[e].push(d));return l.action="ms_submit",h=j.parents(".wpmui-popup"),f=h.length,f?h.addClass("wpmui-loading"):g=i.ajax_show_indicator(j),jQuery(document).trigger("ms-ajax-form-send",[j,l,f,g]),jQuery.post(window.ajaxurl,l,function(a){var b=i.ajax_error(a,g);h.length&&h.removeClass("wpmui-loading"),b||f&&i.close_dialogs(),jQuery(document).trigger("ms-ajax-form-done",[j,a,b,l,f,g])}),!1},ajax_error:function(a,b){var c=0,d=[],e="",f=window.ms_functions;return isNaN(a)?(d=a.split(":",2),isNaN(d[0])||(c=d[0]),void 0!==d[1]&&(e=d[1])):c=a,c<0?(b&&(b.removeClass("okay").addClass("error"),b.find(".err-code").text(e),f.ajax_hide_message(8e3,b)),!0):(b&&(b.removeClass("error").addClass("okay"),b.find(".err-code").text(""),f.ajax_hide_message(4e3,b)),!1)},ajax_show_indicator:function(a){var b;window.ms_functions;return b=a.nearest(".ms-save-text-wrapper"),null!==b.data("msg_timeout")&&(window.clearTimeout(b.data("msg_timeout")),b.data("msg_timeout",null)),b.addClass("ms-processing"),b.removeClass("error okay"),b},ajax_hide_message:function(a,b){var c;window.ms_functions;isNaN(a)&&(a=4e3),a<0&&(a=0),c=window.setTimeout(function(){b.removeClass("error okay")},a),b.data("msg_timeout",c)},select_all:function(a){var b;a=jQuery(a)[0],document.selection?(b=document.body.createTextRange(),b.moveToElementText(a),b.select()):window.getSelection&&(b=document.createRange(),b.selectNode(a),window.getSelection().addRange(b))},toggle_box:function(a,b){var c=jQuery(b),d=c.closest(".ms-settings-box");if(d.hasClass("static"))return!1;d.hasClass("closed")?d.removeClass("closed").addClass("open"):d.removeClass("open").addClass("closed")},toggle_datepicker:function(a){jQuery(a).closest(".wpmui-datepicker-wrapper").find(".wpmui-datepicker").datepicker("show")},tag_selector_add:function(a){var b=window.ms_functions,c=jQuery(this).closest(".wpmui-tag-selector-wrapper"),d=c.find("select.wpmui-tag-source"),e=c.find("select.wpmui-tag-data"),f=e.val()||[];d.val().length&&(f.push(d.val()),e.val(f).trigger("change"),d.val("").trigger("change"),b.tag_selector_refresh_source(a,this))},tag_selector_refresh_source:function(a,b){var c=0,d=null,e=jQuery(b).closest(".wpmui-tag-selector-wrapper"),f=e.find("select.wpmui-tag-source"),g=f.find("option"),h=e.find("select.wpmui-tag-data"),i=h.val()||[];for(c=0;c<g.length;c+=1)d=jQuery(g[c]),-1!==jQuery.inArray(d.val(),i)?d.prop("disabled",!0):d.prop("disabled",!1);f.trigger("change")},reload:function(){window.location.reload()},show_dialog:function(a){var b,c=jQuery(this),d=(window.ms_functions,{});if(a.preventDefault(),void 0!==(b=c.attr("data-ms-data")))try{d=jQuery.parseJSON(b)}catch(a){d={}}return d.action="ms_dialog",d.dialog=c.attr("data-ms-dialog"),jQuery(document).trigger("ms-load-dialog",[d]),c.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,d,function(a){var b=!1;c.removeClass("wpmui-loading");try{b=jQuery.parseJSON(a)}catch(a){b=!1}b.title=b.title||"Dialog",b.height=b.height||100,b.width=b.width>0?b.width:void 0,b.content=b.content||"",b.modal=b.modal||!0,wpmUi.popup().modal(!0,!b.modal).title(b.title).size(b.width,b.height).content(b.content).show()}),!1},close_dialogs:function(){var a,b=wpmUi.popups();for(a in b)b[a].close()},update_view_count:function(a,b,c){var d=jQuery(this),e=d.closest(".wp-list-table"),f=e.closest("form"),g=f.parent(),h=g.find(".subsubsub").first(),i=h.find(".has_access .count"),j=h.find(".no_access .count"),k=parseInt(i.text().replace(/\D/,"")),l=parseInt(j.text().replace(/\D/,""));isNaN(k)&&(k=0),isNaN(l)&&(l=0),b.value?(l-=1,k+=1):(l+=1,k-=1),k<0&&(k=0),l<0&&(l=0),0===k?i.text(""):i.text("("+k+")"),0===l?j.text(""):j.text("("+l+")")},submit_form:function(){var a=jQuery(this),b=a.data("form"),c=jQuery("form."+b);c.length&&c.submit()}},jQuery.fn.ms_datepicker=function(a){var b=null,c=window.ms_functions,d=jQuery.extend(c.dp_config,a);return"function"==typeof d.beforeShow&&(b=d.beforeShow),d.beforeShow=function(a,c){void 0!==c&&void 0!==c.dpDiv&&jQuery(c.dpDiv).addClass(d.custom_class),window.setTimeout(function(){jQuery(c.dpDiv).css({"z-index":"10"})},20),null!==b&&b(a,c)},this.each(function(){jQuery(this).datepicker(d)})},jQuery(document).ready(function(){var a=window.ms_functions;jQuery("body").on("click",".wpmui-radio-slider",function(b){a.radio_slider_ajax_update(this)}).on("click",".ms-settings-box .handlediv",function(b){a.toggle_box(b,this)}).on("click",".wpmui-datepicker-wrapper .wpmui-icon",function(b){a.toggle_datepicker(this)}).on("select2-opening",".wpmui-tag-selector-wrapper .wpmui-tag-data",function(a){a.preventDefault()}).on("change",".wpmui-tag-selector-wrapper .wpmui-tag-data",function(b){a.tag_selector_refresh_source(b,this)}).on("click",".wpmui-tag-selector-wrapper .wpmui-tag-button",a.tag_selector_add).on("change","input.wpmui-ajax-update:not([type=number]), select.wpmui-ajax-update, textarea.wpmui-ajax-update",function(b){a.ajax_update(this)}).on("blur",'input.wpmui-ajax-update[type="number"]',function(b){var c=jQuery(this);c.val()!==c.data("val")&&(c.data("val",c.val()),a.ajax_update(this))}).on("change",'input.wpmui-ajax-update[type="number"]',function(a){jQuery(this).focus()}).on("focus",'input.wpmui-ajax-update[type="number"]',function(a){var b=jQuery(this);void 0===b.data("val")&&b.data("val",b.val())}).on("click","button.wpmui-ajax-update",function(b){a.ajax_update(this)}).on("submit","form.wpmui-ajax-update",function(b){a.dynamic_form_submit(b,this)}).on("click","[data-ms-dialog]",a.show_dialog).on("ms-radio-slider-updated",".wp-list-table.rules .wpmui-radio-slider",a.update_view_count).on("click",".ms-submit-form",a.submit_form),jQuery(".ms-wrap").on("click","code",function(){a.select_all(this)}),a.init("body"),jQuery("html").addClass("ms-html")}),function(){var a=null,b=null,c=null;window.ms_inline_editor={init:function(){c=jQuery(".ms-wrap #inline-edit"),c.detach(),c.keyup(function(a){if(27===a.which)return ms_inline_editor.revert()}),jQuery("a.cancel",c).click(function(){return ms_inline_editor.revert()}),jQuery("a.save",c).click(function(){return ms_inline_editor.save(this)}),jQuery("td",c).keydown(function(a){if(13===a.which)return ms_inline_editor.save(this)}),jQuery(".ms-wrap .wp-list-table").on("click","a.editinline",function(){return ms_inline_editor.edit(this),!1})},edit:function(d){var e,f;return ms_inline_editor.revert(),"object"==typeof d&&(d=ms_inline_editor.get_id(d)),a=c.clone(!0),b=jQuery("#item-"+d),jQuery("td",a).attr("colspan",jQuery(".widefat:first thead th:visible").length),b.hasClass("alternate")&&a.addClass("alternate"),b.hide().after(a),f={},e=b.find(".inline_data"),e.children().each(function(){var b=jQuery(this),c=b.attr("class"),d=a.find(':input[name="'+c+'"]'),e=a.find(".lbl-"+c);f[c]=b.text(),d.length&&d.val(f[c]),e.length&&e.text(f[c])}),jQuery(document).trigger("ms-inline-editor",[a,b,f]),a.attr("id","edit-"+d).addClass("inline-editor").show(),a.find(":input:visible").first().focus(),!1},save:function(c){var d;return"object"==typeof c&&(c=ms_inline_editor.get_id(c)),a.find("td").addClass("wpmui-loading"),d=a.find(":input").serialize(),jQuery.post(window.ajaxurl,d,function(c){a.find("td").removeClass("wpmui-loading"),c?-1!==c.indexOf("<tr")?(b.remove(),b=jQuery(c),a.before(b).remove(),b.hide().fadeIn(),ms_inline_editor.update_alternate(b),jQuery(document).trigger("ms-inline-editor-updated",[b])):(c=c.replace(/<.[^<>]*?>/g,""),a.find(".error").html(c).show()):a.find(".error").html(ms_data.lang.quickedit_error).show(),b.prev().hasClass("alternate")&&b.removeClass("alternate")},"html"),!1},revert:function(){return a&&(a.remove(),b.show(),a=null,b=null),!1},update_alternate:function(a){var b,c,d,e=jQuery(a).closest("tbody"),f=e.find("tr:visible");for(b=0,c=f.length;b<c;b++)d=jQuery(f[b]),b%2==0?d.addClass("alternate"):d.removeClass("alternate")},get_id:function(a){var b=jQuery(a).closest("tr").attr("id"),c=b.split("-");return c[c.length-1]}},jQuery(function(){ms_inline_editor.init()})}(),jQuery(function(){jQuery(document).click(function(){function a(){var a=jQuery(this),b=a.attr("timestamp"),c=jQuery('.wpmui-tooltip-wrapper[timestamp="'+b+'"]').first();a.hide(),a.appendTo(jQuery(c))}jQuery(".wpmui-tooltip[timestamp]").each(a)}),jQuery(".wpmui-tooltip-button").click(function(){var a=jQuery(this),b=a.parents(".wpmui-tooltip"),c=jQuery(b).attr("timestamp"),d=jQuery('.wpmui-tooltip-wrapper[timestamp="'+c+'"]').first();jQuery(b).hide(),jQuery(b).appendTo(jQuery(d))}),jQuery(".wpmui-tooltip").click(function(a){a.stopPropagation()}),jQuery(".wpmui-tooltip-info").click(function(a){var b,c,d,e,f,g=jQuery(this);g.toggleClass("open"),g.hasClass("open")?(g.parents(".wpmui-tooltip-wrapper").attr("timestamp",a.timeStamp),a.stopPropagation(),f=g.siblings(".wpmui-tooltip"),f.attr("timestamp",a.timeStamp),e=g.offset(),f.appendTo("#wpcontent"),f.css({left:e.left+25,top:e.top-40}),f.fadeIn(300)):(b=g.parents(".wpmui-tooltip-wrapper"),c=jQuery(b).attr("timestamp"),d=jQuery('.wpmui-tooltip[timestamp="'+c+'"]').first(),jQuery(d).hide(),jQuery(d).appendTo(jQuery(b)))})}),window.ms_init.controller_adminbar=function(){function a(a){var b=a.currentTarget.value,c=jQuery("#wpadminbar #view-as-selector").find('option[value="'+b+'"]').attr("nonce");jQuery("#wpadminbar #ab-membership-id").val(b),jQuery("#wpadminbar #view-site-as #_wpnonce").val(c),jQuery("#wpadminbar #view-site-as").submit()}jQuery("#wp-admin-bar-membership-simulate").find("a").click(function(a){jQuery("#wp-admin-bar-membership-simulate").removeClass("hover").find("> div").filter(":first-child").html(ms_data.switching_text)}),jQuery(".ms-date").ms_datepicker(),jQuery("#wpadminbar #view-site-as").parents("#wpadminbar").addClass("simulation-mode"),jQuery("#wpadminbar #view-as-selector").change(a)},window.ms_init.view_help=function(){function a(){jQuery(this).parents(".ms-help-box").first().find(".ms-help-details").toggle()}jQuery(".ms-help-toggle").click(a)},window.ms_init.view_billing_edit=function(){var a={onkeyup:!1,errorClass:"ms-validation-error",rules:{name:"required",user_id:{required:!0,min:1},membership_id:{required:!0,min:1},amount:{required:!0,min:0},due_date:{required:!0,dateISO:!0}}};jQuery(".ms-form").validate(a)},window.ms_init.view_billing_transactions=function(){function a(a){var b=wpmUi.ajax(),c=b.extract_data(j);return j.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,c,function(a){a.success&&(wpmUi.message(a.data.message),f())},"json").always(function(){j.removeClass("wpmui-loading")}),!1}function b(a){var b=jQuery(this).closest("td"),c=b.find("input[name=nonce_update]").val(),d=b.closest(".item"),e=d.attr("id").replace(/^item-/,""),f={};return!!d.hasClass("log-ignore")&&(f.action="transaction_update",f._wpnonce=c,f.id=e,f.state="clear",b.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,f,function(a){d.removeClass("log-ignore is-manual").addClass("log-err")}).always(function(){b.removeClass("wpmui-loading")}),!1)}function c(a){var b=jQuery(this).closest("td"),c=b.find("input[name=nonce_update]").val(),d=b.closest(".item"),e=d.attr("id").replace(/^item-/,""),f={};return!!d.hasClass("log-err")&&(f.action="transaction_update",f._wpnonce=c,f.id=e,f.state="ignore",b.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,f,function(a){d.removeClass("log-err").addClass("log-ignore is-manual")}).always(function(){b.removeClass("wpmui-loading")}),!1)}function d(a){var b=jQuery(this).closest("td"),c=b.find("input[name=nonce_retry]").val(),d=b.closest(".item"),e=d.attr("id").replace(/^item-/,""),f={};return!(!d.hasClass("log-err")&&!d.hasClass("log-ignore"))&&(f.action="transaction_retry",f._wpnonce=c,f.id=e,b.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,f,function(a){a.success&&a.data.desc&&(d.removeClass("log-err log-ignore log-ok"),d.addClass("log-"+a.data.state),d.find(".column-note .txt").text(a.data.desc))},"json").always(function(){b.removeClass("wpmui-loading")}),!1)}function e(a){var b=jQuery(this).closest("td"),c=b.find("input[name=nonce_link]").val(),d=b.closest(".item"),e=d.attr("id").replace(/^item-/,""),f={};return!!d.hasClass("log-err")&&(f.action="transaction_link",f._wpnonce=c,f.id=e,b.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,f,function(a){a.length&&g(d,a)}).always(function(){b.removeClass("wpmui-loading")}),!1)}var f,g,h,i=jQuery(".wp-list-table.transactions, .wp-list-table.transaction_matches"),j=jQuery(".transaction-matching"),k=i.find(".action-clear"),l=i.find(".action-ignore"),m=i.find(".action-link"),n=i.find(".action-retry"),o=j.find(".action-match");f=function(){function a(){if(!g.length)return void d.$().remove();var b=g.shift(),c=jQuery.extend({},f),h=i.find("#item-"+b);c.id=b,e+=1,d.value(e),jQuery.post(window.ajaxurl,c,function(b){b.success&&b.data.desc&&(h.removeClass("log-err log-ignore log-ok"),h.addClass("log-"+b.data.state),h.find(".column-note .txt").text(b.data.desc)),window.setTimeout(function(){a()},1)},"json").always(function(){h.find(".column-note").removeClass("wpmui-loading")})}var b=i.find(".item"),c=j.find(".retry_nonce").val(),d=wpmUi.progressbar(),e=0,f={},g=[];f.action="transaction_retry",f._wpnonce=c,b.each(function(){var a=jQuery(this),b=a.attr("id").replace(/^item-/,"");a.find(".column-note").addClass("wpmui-loading"),g.push(b)}),d.value(0),d.max(g.length),d.$().insertBefore(j),j.hide(),a()},g=function(a,b){function c(){var a,b=g.val();if(isNaN(b)||b<1)return n.find(".wpmui-label-after").hide(),m.hide(),n.hide(),!1;a={action:"transaction_link_data",_wpnonce:k.val(),get:"subscriptions",for:b},i.empty(),j.empty(),m.show().addClass("wpmui-loading"),n.find(".wpmui-label-after").hide(),n.hide(),o.prop("disabled",!0).addClass("disabled"),jQuery.post(window.ajaxurl,a,function(a){jQuery.each(a,function(a,b){h(i,a,b)})},"json").always(function(){m.removeClass("wpmui-loading")})}function d(){var a,b=i.val();if(isNaN(b)||b<1)return n.find(".wpmui-label-after").hide(),n.hide(),!1;a={action:"transaction_link_data",_wpnonce:k.val(),get:"invoices",for:b},j.empty(),n.show().addClass("wpmui-loading"),n.find(".wpmui-label-after").hide(),o.prop("disabled",!0).addClass("disabled"),jQuery.post(window.ajaxurl,a,function(a){window.console.log(a),jQuery.each(a,function(a,b){window.console.log(a,b),h(j,a,b)})},"json").always(function(){n.removeClass("wpmui-loading")})}function e(){var a=j.val();!isNaN(a)&&a>0?(n.find(".wpmui-label-after").show(),o.prop("disabled",!1).removeClass("disabled")):(n.find(".wpmui-label-after").hide(),o.prop("disabled",!0).addClass("disabled"))}function f(){var b={action:"transaction_update",_wpnonce:l.val(),id:p.val(),link:j.val()};if(!b.link)return!1;r.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,b,function(b){"3"===b&&(a.removeClass("log-err").addClass("log-ok is-manual"),q.close())}).always(function(){r.removeClass("wpmui-loading")})}var g,i,j,k,l,m,n,o,p,q=wpmUi.popup(),r=q.$();q.modal(!0),q.title(ms_data.lang.link_title),q.content(b),q.show(),g=r.find("select[name=user_id]"),i=r.find("select[name=subscription_id]"),j=r.find("select[name=invoice_id]"),r.find(".link-member"),m=r.find(".link-subscription"),n=r.find(".link-invoice"),k=r.find("input[name=nonce_link_data]"),l=r.find("input[name=nonce_update]"),p=r.find("input[name=log_id]"),o=r.find("button[name=submit]"),m.hide(),n.hide(),o.prop("disabled",!0).addClass("disabled"),g.change(c),i.change(d),j.change(e),o.click(f),!isNaN(g.val())&&g.val()>0&&c()},h=function(a,b,c){if("object"==typeof c){var d=jQuery("<optgroup></optgroup>");d.attr("label",b),jQuery.each(c,function(a,b){h(d,a,b)}),a.append(d)}else a.append(jQuery("<option></option>").val(b).html(c))},k.click(b),l.click(c),m.click(e),n.click(d),o.click(a)},window.ms_init.view_member_date=function(){jQuery(".ms-date").ms_datepicker()},window.ms_init.view_member_editor=function(){function a(a,c){var d=c.val(),e={},f=c.closest(".wpmui-wrapper");e.action="member_validate_field",e.field=a,e.value=d,f.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,e,function(a){var d=f.find(".wpmui-label-after");f.removeClass("wpmui-loading"),"1"===a?(c.removeClass("invalid"),c.addClass("valid"),d.html("")):(c.removeClass("valid"),c.addClass("invalid"),d.html(a)),b()})}var b,c=jQuery("#username"),d=jQuery("#email"),e=jQuery(".ms-group-select #user_id"),f=jQuery("#btn_create"),g=jQuery("#btn_select"),h={};b=function(){c.hasClass("valid")&&d.hasClass("valid")?(f.prop("disabled",!1),f.removeClass("disabled")):(f.prop("disabled",!0),f.addClass("disabled")),e.val()?(g.prop("disabled",!1),g.removeClass("disabled")):(g.prop("disabled",!0),g.addClass("disabled"))},c.change(function(){a("username",c)}),d.change(function(){a("email",d)}),e.change(b),h.minimumInputLength=3,h.multiple=!1,h.ajax={url:window.ajaxurl,dataType:"json",type:"GET",delay:100,data:function(a){return{action:"member_search",q:a.term,p:a.page}},processResults:function(a,b){return{results:a.items,more:a.more}}},e.removeClass("wpmui-hidden"),e.wpmuiSelect(h),b()},window.ms_init.view_member_list=function(){window.ms_init.memberships_column(".column-membership")},window.ms_init.view_membership_add=function(){var a=jQuery("input#public"),b=a.closest(".opt"),c=jQuery("input#paid"),d=jQuery("input#name"),e=d.closest(".opt"),f=c.closest(".opt");jQuery("#ms-choose-type-form").validate({onkeyup:!1,errorClass:"ms-validation-error",rules:{name:{required:!0}}}),jQuery('input[name="type"]').click(function(){var g=jQuery('input[name="type"]'),h=g.filter(":checked"),i=h.val();g.closest(".wpmui-radio-input-wrapper").removeClass("active"),h.closest(".wpmui-radio-input-wrapper").addClass("active"),"guest"===i||"user"===i?(a.prop("disabled",!0),c.prop("disabled",!0),d.prop("readonly",!0),b.addClass("disabled ms-locked"),f.addClass("disabled ms-locked"),e.addClass("disabled ms-locked"),d.val(h.next(".wpmui-radio-caption").text())):(a.prop("disabled",!1),c.prop("disabled",!1),d.prop("readonly",!1),b.removeClass("disabled ms-locked"),f.removeClass("disabled ms-locked"),e.removeClass("disabled ms-locked"),d.val("").focus())}).filter(":checked").trigger("click"),jQuery("#cancel").click(function(){var a=jQuery(this);a.on("ms-ajax-updated",function(){window.location=ms_data.initial_url}),ms_functions.ajax_update(a)})},window.ms_init.view_membership_list=function(){function a(a){var b,c=jQuery(this),d=c.parents("tr"),e=d.find(".column-name .the-name").text(),f=c.attr("href");return a.preventDefault(),b={message:ms_data.lang.msg_delete.replace("%s",e),buttons:[ms_data.lang.btn_delete,ms_data.lang.btn_cancel],callback:function(a){0===a&&(window.location=f)}},wpmUi.confirm(b),!1}jQuery("#the-list-membership").on("click",".delete a",a),jQuery(document).on("ms-ajax-form-done",function(a,b,c,d,e){d||window.location.reload()})},window.ms_init.bulk_delete_membership=function(){function a(a){var b,d=jQuery(this);d.parents("tr"),d.attr("href");return a.preventDefault(),b={message:ms_data.lang.msg_bulk_delete,buttons:[ms_data.lang.btn_delete,ms_data.lang.btn_cancel],callback:function(a){0===a&&(window.location=c())}},wpmUi.confirm(b),!1}var b=jQuery(".bulk_delete_memberships_button").attr("href"),c=function(){var a=[];return jQuery("input.del_membership_ids:checked").each(function(){a.push(jQuery(this).val())}),a.length>0?b+"&membership_ids="+a.join("-"):b};jQuery(".bulk_delete_memberships_button").click(a)},window.ms_init.metabox=function(){function a(a,e){c.filter(".on,.wpmui-loading").length?(d.show(),b.addClass("on")):(d.hide(),b.removeClass("on"))}var b=jQuery(".ms-protect-content"),c=jQuery(".ms-protection-rule"),d=jQuery("#ms-metabox-access-wrapper");b.hasClass("on")?d.show():d.hide(),jQuery(".dripped").click(function(){jQuery(this).children(".tooltip").toggle(300)}),window.ms_init.ms_metabox_event=function(a,c){jQuery("#ms-metabox-wrapper").replaceWith(c.response),window.ms_init.metabox(),jQuery(".wpmui-radio-slider").click(function(){window.ms_functions.radio_slider_ajax_update(this)}),b.on("ms-radio-slider-updated",function(a,b){window.ms_init.ms_metabox_event(a,b)})},b.on("ms-radio-slider-updated",function(a,b){window.ms_init.ms_metabox_event(a,b)}),c.on("ms-radio-slider-updated",function(b,c){a(b,c)})},window.ms_init.view_membership_overview=function(){jQuery(".wpmui-radio-slider").on("ms-radio-slider-updated",function(){var a=this,b=jQuery("#ms-membership-status");jQuery(a).hasClass("on")?b.addClass("ms-active"):b.removeClass("ms-active")}),jQuery(document).on("ms-ajax-form-done",function(a,b,c,d,e){d||window.location.reload()})},window.ms_init.view_membership_urlgroup=function(){var a=!1;ms_functions.test_url=function(){a&&window.clearTimeout(a),a=window.setTimeout(function(){var a=jQuery("#url-test-results-wrapper"),b=jQuery.trim(jQuery("#url_test").val()),c=jQuery("#rule_value").val().split("\n"),d=jQuery("#is_regex").val();d="true"===d||"1"===d,a.empty().hide(),""!==b&&(jQuery.each(c,function(c,e){var f,g,h,i;""!==(e=jQuery.trim(e))&&(f=jQuery("<div />").addClass("ms-rule-test"),jQuery("<span />").appendTo(f).text(e).addClass("ms-test-url"),g=jQuery("<span />").appendTo(f).addClass("ms-test-result"),i=!1,d?(h=new RegExp(e,"i"),i=h.test(b)):i=b.indexOf(e)>=0,i?(f.addClass("ms-rule-valid"),g.text(ms_data.valid_rule_msg)):(f.addClass("ms-rule-invalid"),g.text(ms_data.invalid_rule_msg)),a.append(f))}),a.find("> div").length||a.html("<div><i>"+ms_data.empty_msg+"</i></div>"),a.show())},500)},jQuery("#url_test, #rule_value").keyup(ms_functions.test_url)},window.ms_init.view_membership_payment=function(){function a(){var a=jQuery(this),b=a.closest(".ms-payment-form"),c=a.val(),d=b.find(".ms-payment-type-wrapper"),e=b.find(".ms-payment-type-"+c),f=b.find(".ms-payment-types-wrapper");d.hide(),e.show(),"permanent"===c?f.hide():f.show()}function b(){var a=jQuery(this).val(),b=jQuery(".ms-payment-structure-wrapper");switch(a){case"USD":a="$";break;case"EUR":a="&euro;";break;case"JPY":a="&yen;"}b.find(".wpmui-label-before").html(a)}function c(a,b,c){b.value?jQuery(".ms-trial-period-details").show():jQuery(".ms-trial-period-details").hide()}function d(a,b,c,d){d||(jQuery(".ms-specific-payment-wrapper").addClass("wpmui-loading"),window.location.reload())}jQuery("#payment_type").change(a),jQuery("#payment_type").each(a),jQuery("#currency").change(b),jQuery(".wpmui-slider-trial_period_enabled").on("ms-radio-slider-updated",c),jQuery(document).on("ms-ajax-updated","#enable_trial_addon",d)},window.ms_init.view_protected_content=function(){function a(a){var b,c,d=jQuery(this).closest(".column-access"),e=d.closest("tr.item"),f=d.find("select.ms-memberships"),g=f.val(),h=0;if(g&&g.length)for(b in g)c=g[b],void 0!==ms_data.dripped[c]&&(h+=1);h>1?e.addClass("ms-dripped"):1===h?e.addClass("ms-dripped"):e.removeClass("ms-dripped")}function b(a,b,c,d){var f,g,h=c.find("select.ms-memberships option:selected"),i=b.find(".dripped-form"),j=b.find(".dynamic-form");for(f=0,g=h.length;f<g;f++){var k=jQuery(h[f]),l=k.val(),m=k.data("color"),n=i.clone(!1),o="ms_"+l;void 0!==ms_data.dripped[l]&&(n.find(".the-name").text(ms_data.dripped[l]).css({background:m}),n.find("[name=membership_ids]").attr("name","membership_ids[]").val(l),n.find("[name=item_id]").val(d.item_id),n.find("[name=offset]").val(d.offset),n.find("[name=number]").val(d.number),n.find("[name=dripped_type]").attr("name",o+"[dripped_type]").val(d[o+"[dripped_type]"]),n.find("[name=date]").attr("name",o+"[date]").val(d[o+"[date]"]),n.find("[name=delay_unit]").attr("name",o+"[delay_unit]").val(d[o+"[delay_unit]"]),n.find("[name=delay_type]").attr("name",o+"[delay_type]").val(d[o+"[delay_type]"]),n.appendTo(j).removeClass("hidden"),e(n))}i.remove()}function c(b,c){window.ms_init.memberships_column(".column-access"),c.find(".ms-memberships").each(function(){a.apply(this)})}function d(a){var b=g.val();window.location.href=b,g.addClass("wpmui-loading")}var e,f=jQuery(".wp-list-table"),g=jQuery("#select-site");window.ms_init.memberships_column(".column-access"),e=function(a){var b=a.find("select.dripped_type"),c=a.find(".wpmui-datepicker");b.change(function(){var a=jQuery(this),b=a.val(),c=a.closest(".dripped-form").find(".drip-option");c.removeClass("active"),c.filter("."+b).addClass("active")}).trigger("change"),c.ms_datepicker()},f.on("ms-ajax-updated",".ms-memberships",a),f.find(".ms-memberships").each(function(){a.apply(this)}),jQuery(document).on("ms-inline-editor",b),jQuery(document).on("ms-inline-editor-updated",c),g.on("change",d)},window.ms_init.memberships_column=function(a){function b(b){var c=jQuery(this).closest(a),d=c.closest("tr.item"),e=c.find("select.ms-memberships");d.removeClass("ms-empty").addClass("ms-assigned"),c.addClass("ms-focused"),e.wpmuiSelect("focus"),e.wpmuiSelect("open")}function c(b){var c=jQuery(this).closest(a),d=c.closest("tr.item"),e=c.find("select.ms-memberships"),f=e.val();c.removeClass("ms-focused"),f&&f.length||d.removeClass("ms-assigned").addClass("ms-empty")}function d(a){var b=a.element;return"<span "+('class="val" style="background: '+jQuery(b).data("color")+'"')+">&emsp;</span> "+a.text}function e(a,b){var c=a.element;return b.css({background:jQuery(c).data("color")}),b.addClass("val"),'<span class="txt">'+a.text+"</span>"}var f=jQuery(".wp-list-table");f.on("click",".ms-empty-note-wrapper .wpmui-label-after",b),f.on("ms-ajax-updated",".ms-memberships",c),f.on("blur",".ms-memberships",function(a){var b=jQuery(this);window.setTimeout(function(){c.apply(b,a)},250)}),jQuery("select.ms-memberships").wpmuiSelect({templateResult:d,templateSelection:e,escapeMarkup:function(a){return a},dropdownCssClass:"ms-memberships wpmui-select2",width:"100%"})},window.ms_init.view_membership_upgrade=function(){function a(){var a=jQuery(this),b=a.hasClass("on"),c=a.closest(".ms-allow"),d=c.next(".ms-update-replace");d.length&&(b?d.hide():d.show())}var b=jQuery(".ms-allow .wpmui-radio-slider");b.on("ms-radio-slider-updated",a),b.each(function(){a.apply(this)})},window.ms_init.view_addons=function(){function a(a,b,c){switch(b){case"options":c.hide().filter(".ms-options").show()}}function b(a,b,c,d){d.removeClass("wpmui-loading"),e.addClass("wpmui-loading")}function c(a,b,c,d){e.removeClass("wpmui-loading")}function d(a){var b=jQuery(a.target),c=b.closest(".list-card-top"),d=c.find(".details"),e=d.find(".wpmui-ajax-update-wrapper");b.hasClass("wpmui-ajax-update")||(b=b.find(".wpmui-ajax-update")),b.closest(".details").length||(b.hasClass("on")?e.removeClass("disabled"):e.addClass("disabled"))}var e=jQuery(".ms-addon-list");jQuery(document).on("list-filter",a),jQuery(document).on("ms-ajax-start",b),jQuery(document).on("ms-ajax-updated",d),jQuery(document).on("ms-ajax-done",c),jQuery(".list-card-top .wpmui-ajax-update-wrapper").each(function(){jQuery(this).trigger("ms-ajax-updated")})},window.ms_init.view_settings=function(){function a(a,b,c,d){var e=jQuery("select.wpmui-wp-pages"),f=e.map(function(){return jQuery(this).val()});e.each(function(){var a,b=jQuery(this),c=b.find("option"),d=b.parents(".ms-settings-page-wrapper").first(),e=d.find(".ms-action a"),g=b.val();for(c.prop("disabled",!1),a=0;a<f.length;a+=1)g!==f[a]&&c.filter('[value="'+f[a]+'"]').prop("disabled",!0);e.each(function(){var a=jQuery(this),b=a.data("wpmui-ajax"),c=b.base+g;void 0===g||isNaN(g)||g<1?(a.addClass("disabled"),a.attr("href","")):(a.removeClass("disabled"),a.attr("href",c))})})}function b(a){var b=jQuery(this);if(b.hasClass("disabled")||!b.attr("href").length)return a.preventDefault(),!1}function c(){window.location=ms_data.initial_url}function d(a,b){b.value?(jQuery("#wp-admin-bar-ms-unprotected").hide(),jQuery("#wp-admin-bar-ms-test-memberships").show()):(jQuery("#wp-admin-bar-ms-unprotected").show(),jQuery("#wp-admin-bar-ms-test-memberships").hide())}function e(a,b){b.value?jQuery(".ms-settings-email-cron").show():jQuery(".ms-settings-email-cron").hide();var c=jQuery(".wpmui-slider-enable_cron_use .wpmui-toggle").attr("data-wpmui-ajax");c=JSON.parse(c),jQuery.post(window.ajaxurl,{action:"toggle_cron",_wpnonce:c._wpnonce},function(){})}jQuery("#initial_setup").on("ms-ajax-updated",c),jQuery(".wpmui-slider-plugin_enabled").on("ms-radio-slider-updated",d),jQuery(".wpmui-slider-enable_cron_use").on("ms-radio-slider-updated",e),jQuery(".wpmui-wp-pages").on("ms-ajax-updated",a),jQuery(".ms-action a").on("click",b),jQuery(function(){a()})},window.ms_init.view_settings_automated_msg=function(){function a(){var a=jQuery(this),b=a.closest("form"),c=0;for(c=0;c<window.tinymce.editors.length;c+=1)if(window.tinymce.editors[c].isDirty()){d=!0;break}if(d&&!window.confirm(ms_data.lang_confirm))return!1;b.submit()}function b(){d=!0}function c(){
var a=jQuery(this),b=a.closest(".ms-settings-wrapper"),c=b.find(".ms-editor-form");a.hasClass("on")?c.show():c.hide()}var d=!1;jQuery("#switch_comm_type").click(a),jQuery("input, select, textarea",".ms-editor-form").change(b),jQuery(".override-slider").each(function(){c.apply(this)}).on("ms-ajax-done",c),window.tinymce.PluginManager.add("ms_variable",function(a,b){function c(){a.insertContent(this.value())}var d,e,f=[];for(d in ms_data.var_button.items)ms_data.var_button.items.hasOwnProperty(d)&&(e=ms_data.var_button.items[d],f.push({text:e,value:d,onclick:c}));a.addButton("ms_variable",{text:ms_data.var_button.title,icon:!1,type:"menubutton",menu:f})})},window.ms_init.view_settings_import=function(){function a(){return void 0!==document.createElement("a").download&&void 0!==window.Blob&&void 0!==window.JSON&&void 0!==window.JSON.stringify}function b(b,c,d){var e,f;if(!a())return!1;d||(d="application/octet-stream"),e=document.createElement("a"),f=new window.Blob([b],{type:d}),e.href=window.URL.createObjectURL(f),e.download=c,e.click()}function c(){var a;void 0!==window._ms_import_obj&&(a=window.JSON.stringify(window._ms_import_obj),b(a,"protected-content.json"))}function d(){var a=jQuery("<div></div>");o=wpmUi.progressbar(),a.append(o.$()),n=wpmUi.popup().title(ms_data.lang.progress_title,!1).modal(!0,!1).content(a,!0).size(600,140).show()}function e(){var a=jQuery('<div style="text-align:center"></div>'),b=jQuery('<a href="#" class="close"></a>');b.text(ms_data.lang.close_progress),ms_data.close_link&&b.attr("href",ms_data.close_link),b.addClass("button-primary"),b.appendTo(a),n.content(a,!0).modal(!0,!0).title(ms_data.lang.import_done)}function f(a){var b,c={},d=0;for(c.items=[],c.item_count=0,c.label="",c.source=window._ms_import_obj.source_key,d=0;d<a&&void 0!==(b=p.shift());d+=1)c.label=b.label,delete b.label,c.items.push(b),c.item_count+=1;return c}function g(){var a=m.val(),b=f(a);if(!b.item_count)return void e();o.value(q-p.length).label('<i class="wpmui-loading-icon"></i> <span>'+b.label+"</span>"),b.action=k.val(),delete b.label,jQuery.post(window.ajaxurl,b,g)}function h(){var a,b,c,e=ms_data.lang;p=[],p.push({task:"start",clear:l.is(":checked"),label:e.task_start}),c=0;for(a in window._ms_import_obj.memberships)b=window._ms_import_obj.memberships[a],c+=1,p.push({task:"import-membership",data:b,label:e.task_import_membership+": "+c+"..."});c=0;for(a in window._ms_import_obj.members)b=window._ms_import_obj.members[a],c+=1,p.push({task:"import-member",data:b,label:e.task_import_member+": "+c+"..."});for(a in window._ms_import_obj.settings)b=window._ms_import_obj.settings[a],p.push({task:"import-settings",setting:a,value:b,label:e.task_import_settings+"..."});p.push({task:"done",label:e.task_done}),d(),q=p.length,o.max(q),g()}var i=jQuery(".ms-settings-import"),j=i.find("#btn-download"),k=i.find("#btn-import"),l=i.find("#clear_all"),m=i.find("#batchsize"),n=null,o=null,p=[],q=0;a()?j.click(c):j.hide(),k.click(h)},window.ms_init.view_settings_mailchimp=function(){jQuery("#mailchimp_api_key").on("ms-ajax-updated",ms_functions.reload)},window.ms_init.view_settings_payment=function(){function a(a,b,c,d){if(void 0!==b.gateway_id&&"update_gateway"===b.action){var e=jQuery(".gateway-"+b.gateway_id);d?e.removeClass("is-configured is-live is-sandbox").addClass("not-configured"):(e.removeClass("not-configured").addClass("is-configured"),"sandbox"===b.value?e.removeClass("is-live").addClass("is-sandbox"):"live"===b.value&&e.removeClass("is-sandbox").addClass("is-live"))}}function b(a){var b=jQuery(this),c=b.closest(".ms-gateway-item");b.prop("checked")?c.addClass("open"):c.removeClass("open")}function c(){var a=jQuery("#secure_cc").val();"false"!==a&&a?(jQuery(".secure_cc_off").hide(),jQuery(".secure_cc_on").removeClass("hidden").show()):(jQuery(".secure_cc_on").hide(),jQuery(".secure_cc_off").removeClass("hidden").show())}jQuery(document).on("ms-ajax-updated",a),jQuery(document).on("click",".show-settings",b),jQuery(".wpmui-slider-secure_cc").on("ms-ajax-done",c),c()},window.ms_init.view_settings_protection=function(){function a(a,b){var c=jQuery("#"+a.type),d=c.closest(".wp-editor-wrap"),e=window.tinyMCE.get(a.type);return e&&d.hasClass("tmce-active")&&e.save(),a.value=c.val(),a}function b(){var a=jQuery(this),b=a.closest(".inside"),c=b.find(".wp-editor-wrap"),d=b.find(".button-primary");a.hasClass("on")?(d.show(),c.show()):(d.hide(),c.hide())}jQuery(".button-primary.wpmui-ajax-update").data("before_ajax",a),jQuery(".override-slider").each(function(){b.apply(this)}).on("ms-ajax-done",b)},window.ms_init.view_settings_setup=function(){function a(a,b,c,d){var e;d||(e=c.split(":"),void 0!==e[1]&&(e.shift(),jQuery(".ms-nav-controls").replaceWith(e.join(":"))))}function b(a){return e.show(),f.hide(),!1}function c(a){return e.hide(),f.show(),!1}var d=jQuery(".ms-setup-pages-site"),e=d.find(".ms-setup-pages-site-form"),f=d.find(".ms-setup-pages-change-site"),g=d.find(".ms-setup-pages-cancel");jQuery(document).on("ms-ajax-updated","#create_menu",a),f.click(b),g.click(c)};